<div id="invoice-details" class="page-layout carded fullwidth">
    <div class="center" fxLayout="column" fxLayoutGap="10px">
        <mat-card class="cardHeader p-8 pt-4 pb-0 m-0">
            <div fxLayout>
                <div fxFlex fxLayoutAlign="start center" class="h2">
                    <b>Invoice Details</b>
                </div>
                <!-- <div fxFlex fxLayoutAlign="end">
          <button *ngIf="(currentUserRole | lowercase)==='amararaja user' && selection?.selected?.length"
            mat-raised-button class="btnBg" (click)="ApproveSelectedInvoices()">Approve</button>
        </div> -->
            </div>
        </mat-card>

        <div class="sidenav-content mt-4" style="background-color: white">
            <div fxLayout="column" class="mt-10" fusePerfectScrollbar fxFlex>
                <form
                    autocomplete="off"
                    name="form"
                    [formGroup]="InvoiceFilterFormGroup"
                    novalidate
                >
                    <div fxLayout class="mt-4">
                        <!-- <mat-form-field class="mx-8" fxFlex>
              <mat-select matInput formControlName="Status" placeholder="Status">
                <mat-option [value]="rest.value" *ngFor="let rest of AllStatusTemplates">{{rest.key}}
                </mat-option>
              </mat-select>
              <mat-error class="pl-4 errorClass" *ngIf="InvoiceFilterFormGroup.get('Status').touched &&
              InvoiceFilterFormGroup.get('Status').hasError('required')">
                Status is required
              </mat-error>
            </mat-form-field> -->
                        <app-status-controls
                            class="mx-8"
                            fxFlex="18"
                            [AllStatusTemplates]="AllStatusTemplates"
                            formControlName="Status"
                        >
                        </app-status-controls>
                        <mat-form-field class="mx-8" fxFlex="18">
                            <input
                                matInput
                                placeholder="Invoice no"
                                formControlName="InvoiceNumber"
                            />
                        </mat-form-field>
                        <mat-form-field class="mx-8" fxFlex="18">
                            <input
                                matInput
                                [matDatepicker]="picker"
                                placeholder="Start Date"
                                formControlName="StartDate"
                                (keydown)="onKeydown($event)"
                                (dateChange)="DateSelected()"
                            />
                            <mat-datepicker-toggle
                                matSuffix
                                [for]="picker"
                            ></mat-datepicker-toggle>
                            <mat-datepicker #picker></mat-datepicker>
                            <mat-error
                                class="pl-4 errorClass"
                                *ngIf="
                                    InvoiceFilterFormGroup.get('StartDate')
                                        .touched &&
                                    InvoiceFilterFormGroup.get(
                                        'StartDate'
                                    ).hasError('required')
                                "
                            >
                                Start date is required
                            </mat-error>
                        </mat-form-field>
                        <div class="mx-8" fxFlex="18">
                            <mat-form-field>
                                <input
                                    matInput
                                    [matDatepicker]="picker1"
                                    placeholder="End Date"
                                    formControlName="EndDate"
                                    (keydown)="onKeydown($event)"
                                    (dateChange)="DateSelected()"
                                />
                                <mat-datepicker-toggle
                                    matSuffix
                                    [for]="picker1"
                                ></mat-datepicker-toggle>
                                <mat-datepicker #picker1></mat-datepicker>
                                <mat-error
                                    class="pl-4 errorClass"
                                    *ngIf="
                                        InvoiceFilterFormGroup.get('EndDate')
                                            .touched &&
                                        InvoiceFilterFormGroup.get(
                                            'EndDate'
                                        ).hasError('required')
                                    "
                                >
                                    End date is required
                                </mat-error>
                            </mat-form-field>
                            <div
                                *ngIf="isDateError"
                                style="
                                    color: #f44336;
                                    font-size: 12px;
                                    margin-top: -16px;
                                "
                            >
                                End date should not be less than from date
                            </div>
                        </div>
                        <mat-form-field class="mx-8" fxFlex="18">
                            <input
                                matInput
                                placeholder="LR number"
                                formControlName="LRNumber"
                            />
                        </mat-form-field>
                    </div>
                    <div fxLayout class="mt-4">
                        <mat-form-field class="mx-8" fxFlex="18">
                            <mat-select
                                placeholder="Proposed Delivery Date"
                                formControlName="LeadTime"
                                multiple
                            >
                                <mat-option value="within"
                                    >Within PDD</mat-option
                                >
                                <mat-option value="beyond"
                                    >Beyond PDD</mat-option
                                >
                            </mat-select>
                        </mat-form-field>

                        <mat-form-field class="mx-8" fxFlex="18">
                            <mat-select
                                placeholder="Delivery"
                                formControlName="Delivery"
                                multiple
                            >
                                <mat-option value="ontime"
                                    >Ontime Delivery</mat-option
                                >
                                <mat-option value="late"
                                    >Late Delivery</mat-option
                                >
                            </mat-select>
                        </mat-form-field>

                        <div fxFlex class="mx-8 mt-16">
                            <button
                                mat-raised-button
                                class="btnBg"
                                (click)="SearchInvoices()"
                            >
                                Search
                            </button>
                        </div>
                    </div>
                </form>

                <div flex class="mt-10 mr-16">
                    <form
                        autocomplete="off"
                        class="abnormal"
                        fxLayout="column"
                        fxLayoutAlign="start"
                        name="form"
                        novalidate
                        [formGroup]="InvoiceDetailsFormGroup"
                    >
                        <div fxLayout fxLayoutAlign="start center">
                            <div fxFlex>
                                <button
                                    *ngIf="isLoadMoreVisible"
                                    mat-flat-button
                                    class="strokedBtnBg"
                                    (click)="LoadMoreData()"
                                >
                                    Load more..
                                </button>
                            </div>
                            <div fxFlex align="end">
                                <button
                                    (click)="exportAsXLSX()"
                                    class="excelBtn mb-8"
                                    mat-stroked-button
                                >
                                    <img
                                        class="excelImg"
                                        src="assets/images/excel.png"
                                    />
                                    Export to excel
                                </button>
                                <button
                                    (click)="ModifyLayout()"
                                    class="modifyLayoutBtn mb-8"
                                    mat-stroked-button
                                >
                                    <img
                                        class="modifyLayout"
                                        src="assets/images/menu/notepad.png"
                                    />
                                </button>
                            </div>
                        </div>
                        <div class="example-container">
                            <table
                                class="table"
                                mat-table
                                [dataSource]="dataSource"
                                formArrayName="InvoiceDetails"
                            >
                                <ng-container matColumnDef="ORGANIZATION">
                                    <th
                                        [hidden]="isColumnHide('ORGANIZATION')"
                                        mat-header-cell
                                        *matHeaderCellDef
                                    >
                                        Organization
                                    </th>
                                    <td
                                        [hidden]="isColumnHide('ORGANIZATION')"
                                        mat-cell
                                        *matCellDef="
                                            let element;
                                            let index = index
                                        "
                                        (click)="invoiceRowClick(index)"
                                    >
                                        {{
                                            InvoiceDetailsFormGroup.get(
                                                "InvoiceDetails"
                                            )?.controls[index]?.get(
                                                "ORGANIZATION"
                                            )?.value
                                        }}
                                    </td>
                                </ng-container>

                                <ng-container matColumnDef="DIVISION">
                                    <th
                                        [hidden]="isColumnHide('DIVISION')"
                                        mat-header-cell
                                        *matHeaderCellDef
                                    >
                                        Division
                                    </th>
                                    <td
                                        [hidden]="isColumnHide('DIVISION')"
                                        mat-cell
                                        *matCellDef="
                                            let element;
                                            let index = index
                                        "
                                        (click)="invoiceRowClick(index)"
                                    >
                                        {{
                                            InvoiceDetailsFormGroup.get(
                                                "InvoiceDetails"
                                            )?.controls[index]?.get("DIVISION")
                                                ?.value
                                        }}
                                    </td>
                                </ng-container>

                                <ng-container matColumnDef="PLANT">
                                    <th
                                        [hidden]="isColumnHide('PLANT')"
                                        mat-header-cell
                                        *matHeaderCellDef
                                    >
                                        Plant Code
                                    </th>
                                    <td
                                        [hidden]="isColumnHide('PLANT')"
                                        mat-cell
                                        *matCellDef="
                                            let element;
                                            let index = index
                                        "
                                        (click)="invoiceRowClick(index)"
                                    >
                                        {{
                                            InvoiceDetailsFormGroup.get(
                                                "InvoiceDetails"
                                            )?.controls[index]?.get("PLANT")
                                                ?.value
                                        }}
                                    </td>
                                </ng-container>

                                <ng-container matColumnDef="PLANT_NAME">
                                    <th
                                        [hidden]="isColumnHide('PLANT_NAME')"
                                        mat-header-cell
                                        *matHeaderCellDef
                                    >
                                        Plant Name
                                    </th>
                                    <td
                                        [hidden]="isColumnHide('PLANT_NAME')"
                                        mat-cell
                                        *matCellDef="
                                            let element;
                                            let index = index
                                        "
                                        (click)="invoiceRowClick(index)"
                                    >
                                        {{
                                            InvoiceDetailsFormGroup.get(
                                                "InvoiceDetails"
                                            )?.controls[index]?.get(
                                                "PLANT_NAME"
                                            )?.value
                                        }}
                                    </td>
                                </ng-container>

                                <ng-container matColumnDef="ODIN">
                                    <th
                                        [hidden]="isColumnHide('ODIN')"
                                        mat-header-cell
                                        *matHeaderCellDef
                                    >
                                        Invoice No
                                    </th>
                                    <td
                                        [hidden]="isColumnHide('ODIN')"
                                        mat-cell
                                        *matCellDef="
                                            let element;
                                            let index = index
                                        "
                                        (click)="invoiceRowClick(index)"
                                    >
                                        {{
                                            InvoiceDetailsFormGroup.get(
                                                "InvoiceDetails"
                                            )?.controls[index]?.get("ODIN")
                                                ?.value
                                        }}
                                    </td>
                                </ng-container>

                                <ng-container matColumnDef="INV_NO">
                                    <th
                                        [hidden]="isColumnHide('INV_NO')"
                                        mat-header-cell
                                        *matHeaderCellDef
                                    >
                                        Reference No
                                    </th>
                                    <td
                                        [hidden]="isColumnHide('INV_NO')"
                                        mat-cell
                                        *matCellDef="
                                            let element;
                                            let index = index
                                        "
                                        (click)="invoiceRowClick(index)"
                                    >
                                        {{
                                            InvoiceDetailsFormGroup.get(
                                                "InvoiceDetails"
                                            )?.controls[index]?.get("INV_NO")
                                                ?.value
                                        }}
                                    </td>
                                </ng-container>

                                <ng-container matColumnDef="INV_DATE">
                                    <th
                                        [hidden]="isColumnHide('INV_DATE')"
                                        mat-header-cell
                                        *matHeaderCellDef
                                    >
                                        Invoice Date
                                    </th>
                                    <td
                                        [hidden]="isColumnHide('INV_DATE')"
                                        mat-cell
                                        *matCellDef="
                                            let element;
                                            let index = index
                                        "
                                        (click)="invoiceRowClick(index)"
                                    >
                                        {{
                                            InvoiceDetailsFormGroup.get(
                                                "InvoiceDetails"
                                            )?.controls[index]?.get("INV_DATE")
                                                ?.value | date : "dd/MM/yyyy"
                                        }}
                                    </td>
                                </ng-container>

                                <ng-container matColumnDef="INV_TYPE">
                                    <th
                                        [hidden]="isColumnHide('INV_TYPE')"
                                        mat-header-cell
                                        *matHeaderCellDef
                                    >
                                        Invoice Type
                                    </th>
                                    <td
                                        [hidden]="isColumnHide('INV_TYPE')"
                                        mat-cell
                                        *matCellDef="
                                            let element;
                                            let index = index
                                        "
                                        (click)="invoiceRowClick(index)"
                                    >
                                        {{
                                            InvoiceDetailsFormGroup.get(
                                                "InvoiceDetails"
                                            )?.controls[index]?.get("INV_TYPE")
                                                ?.value
                                        }}
                                    </td>
                                </ng-container>

                                <ng-container matColumnDef="INVOICE_QUANTITY">
                                    <th
                                        [hidden]="
                                            isColumnHide('INVOICE_QUANTITY')
                                        "
                                        mat-header-cell
                                        *matHeaderCellDef
                                    >
                                        Invoice Qty
                                    </th>
                                    <td
                                        [hidden]="
                                            isColumnHide('INVOICE_QUANTITY')
                                        "
                                        mat-cell
                                        *matCellDef="
                                            let element;
                                            let index = index
                                        "
                                        (click)="invoiceRowClick(index)"
                                    >
                                        {{
                                            InvoiceDetailsFormGroup.get(
                                                "InvoiceDetails"
                                            )?.controls[index]?.get(
                                                "INVOICE_QUANTITY"
                                            )?.value
                                        }}
                                    </td>
                                </ng-container>

                                <ng-container matColumnDef="OUTBOUND_DELIVERY">
                                    <th
                                        [hidden]="
                                            isColumnHide('OUTBOUND_DELIVERY')
                                        "
                                        mat-header-cell
                                        *matHeaderCellDef
                                    >
                                        Outbound Delivery
                                    </th>
                                    <td
                                        [hidden]="
                                            isColumnHide('OUTBOUND_DELIVERY')
                                        "
                                        mat-cell
                                        *matCellDef="
                                            let element;
                                            let index = index
                                        "
                                        (click)="invoiceRowClick(index)"
                                    >
                                        {{
                                            InvoiceDetailsFormGroup.get(
                                                "InvoiceDetails"
                                            )?.controls[index]?.get(
                                                "OUTBOUND_DELIVERY"
                                            )?.value
                                        }}
                                    </td>
                                </ng-container>

                                <ng-container
                                    matColumnDef="OUTBOUND_DELIVERY_DATE"
                                >
                                    <th
                                        [hidden]="
                                            isColumnHide(
                                                'OUTBOUND_DELIVERY_DATE'
                                            )
                                        "
                                        mat-header-cell
                                        *matHeaderCellDef
                                    >
                                        Outbound Delivery Date
                                    </th>
                                    <td
                                        [hidden]="
                                            isColumnHide(
                                                'OUTBOUND_DELIVERY_DATE'
                                            )
                                        "
                                        mat-cell
                                        *matCellDef="
                                            let element;
                                            let index = index
                                        "
                                        (click)="invoiceRowClick(index)"
                                    >
                                        {{
                                            InvoiceDetailsFormGroup.get(
                                                "InvoiceDetails"
                                            )?.controls[index]?.get(
                                                "OUTBOUND_DELIVERY_DATE"
                                            )?.value | date : "dd/MM/yyyy"
                                        }}
                                    </td>
                                </ng-container>

                                <ng-container matColumnDef="CUSTOMER">
                                    <th
                                        [hidden]="isColumnHide('CUSTOMER')"
                                        mat-header-cell
                                        *matHeaderCellDef
                                    >
                                        Customer
                                    </th>
                                    <td
                                        [hidden]="isColumnHide('CUSTOMER')"
                                        mat-cell
                                        *matCellDef="
                                            let element;
                                            let index = index
                                        "
                                        (click)="invoiceRowClick(index)"
                                    >
                                        {{
                                            InvoiceDetailsFormGroup.get(
                                                "InvoiceDetails"
                                            )?.controls[index]?.get("CUSTOMER")
                                                ?.value
                                        }}
                                    </td>
                                </ng-container>

                                <ng-container matColumnDef="CUSTOMER_NAME">
                                    <th
                                        [hidden]="isColumnHide('CUSTOMER_NAME')"
                                        mat-header-cell
                                        *matHeaderCellDef
                                    >
                                        Customer Name
                                    </th>
                                    <td
                                        [hidden]="isColumnHide('CUSTOMER_NAME')"
                                        mat-cell
                                        *matCellDef="
                                            let element;
                                            let index = index
                                        "
                                        (click)="invoiceRowClick(index)"
                                    >
                                        {{
                                            InvoiceDetailsFormGroup.get(
                                                "InvoiceDetails"
                                            )?.controls[index]?.get(
                                                "CUSTOMER_NAME"
                                            )?.value
                                        }}
                                    </td>
                                </ng-container>

                                <ng-container
                                    matColumnDef="CUSTOMER_DESTINATION"
                                >
                                    <th
                                        [hidden]="
                                            isColumnHide('CUSTOMER_DESTINATION')
                                        "
                                        mat-header-cell
                                        *matHeaderCellDef
                                    >
                                        Customer Destination
                                    </th>
                                    <td
                                        [hidden]="
                                            isColumnHide('CUSTOMER_DESTINATION')
                                        "
                                        mat-cell
                                        *matCellDef="
                                            let element;
                                            let index = index
                                        "
                                        (click)="invoiceRowClick(index)"
                                    >
                                        {{
                                            InvoiceDetailsFormGroup.get(
                                                "InvoiceDetails"
                                            )?.controls[index]?.get(
                                                "CUSTOMER_DESTINATION"
                                            )?.value
                                        }}
                                    </td>
                                </ng-container>

                                <ng-container matColumnDef="DISTANCE">
                                    <th
                                        [hidden]="isColumnHide('DISTANCE')"
                                        mat-header-cell
                                        *matHeaderCellDef
                                    >
                                        Distance
                                    </th>
                                    <td
                                        [hidden]="isColumnHide('DISTANCE')"
                                        mat-cell
                                        *matCellDef="
                                            let element;
                                            let index = index
                                        "
                                        (click)="invoiceRowClick(index)"
                                    >
                                        {{
                                            InvoiceDetailsFormGroup.get(
                                                "InvoiceDetails"
                                            )?.controls[index]?.get("DISTANCE")
                                                ?.value
                                        }}
                                    </td>
                                </ng-container>

                                <ng-container matColumnDef="CUSTOMER_GROUP">
                                    <th
                                        [hidden]="
                                            isColumnHide('CUSTOMER_GROUP')
                                        "
                                        mat-header-cell
                                        *matHeaderCellDef
                                    >
                                        Customer Group Code
                                    </th>
                                    <td
                                        [hidden]="
                                            isColumnHide('CUSTOMER_GROUP')
                                        "
                                        mat-cell
                                        *matCellDef="
                                            let element;
                                            let index = index
                                        "
                                        (click)="invoiceRowClick(index)"
                                    >
                                        {{
                                            InvoiceDetailsFormGroup.get(
                                                "InvoiceDetails"
                                            )?.controls[index]?.get(
                                                "CUSTOMER_GROUP_CODE"
                                            )?.value
                                        }}
                                    </td>
                                </ng-container>

                                <ng-container
                                    matColumnDef="CUSTOMER_GROUP_DESC"
                                >
                                    <th
                                        [hidden]="
                                            isColumnHide('CUSTOMER_GROUP_DESC')
                                        "
                                        mat-header-cell
                                        *matHeaderCellDef
                                    >
                                        Customer Group Desc
                                    </th>
                                    <td
                                        [hidden]="
                                            isColumnHide('CUSTOMER_GROUP_DESC')
                                        "
                                        mat-cell
                                        *matCellDef="
                                            let element;
                                            let index = index
                                        "
                                        (click)="invoiceRowClick(index)"
                                    >
                                        {{
                                            InvoiceDetailsFormGroup.get(
                                                "InvoiceDetails"
                                            )?.controls[index]?.get(
                                                "CUSTOMER_GROUP_DESC"
                                            )?.value
                                        }}
                                    </td>
                                </ng-container>

                                <ng-container matColumnDef="SECTOR_DESCRIPTION">
                                    <th
                                        [hidden]="
                                            isColumnHide('SECTOR_DESCRIPTION')
                                        "
                                        mat-header-cell
                                        *matHeaderCellDef
                                    >
                                        Sector
                                    </th>
                                    <td
                                        [hidden]="
                                            isColumnHide('SECTOR_DESCRIPTION')
                                        "
                                        mat-cell
                                        *matCellDef="
                                            let element;
                                            let index = index
                                        "
                                        (click)="invoiceRowClick(index)"
                                    >
                                        {{
                                            InvoiceDetailsFormGroup.get(
                                                "InvoiceDetails"
                                            )?.controls[index]?.get(
                                                "SECTOR_DESCRIPTION"
                                            )?.value
                                        }}
                                    </td>
                                </ng-container>

                                <ng-container matColumnDef="FWD_AGENT">
                                    <th
                                        [hidden]="isColumnHide('FWD_AGENT')"
                                        mat-header-cell
                                        *matHeaderCellDef
                                    >
                                        Forward Agent
                                    </th>
                                    <td
                                        [hidden]="isColumnHide('FWD_AGENT')"
                                        mat-cell
                                        *matCellDef="
                                            let element;
                                            let index = index
                                        "
                                        (click)="invoiceRowClick(index)"
                                    >
                                        {{
                                            InvoiceDetailsFormGroup.get(
                                                "InvoiceDetails"
                                            )?.controls[index]?.get("FWD_AGENT")
                                                ?.value
                                        }}
                                    </td>
                                </ng-container>

                                <ng-container matColumnDef="LR_NO">
                                    <th
                                        [hidden]="isColumnHide('LR_NO')"
                                        mat-header-cell
                                        *matHeaderCellDef
                                    >
                                        LR Number
                                    </th>
                                    <td
                                        [hidden]="isColumnHide('LR_NO')"
                                        mat-cell
                                        *matCellDef="
                                            let element;
                                            let index = index
                                        "
                                        (click)="invoiceRowClick(index)"
                                    >
                                        {{
                                            InvoiceDetailsFormGroup.get(
                                                "InvoiceDetails"
                                            )?.controls[index]?.get("LR_NO")
                                                ?.value
                                        }}
                                    </td>
                                </ng-container>

                                <ng-container matColumnDef="LR_DATE">
                                    <th
                                        [hidden]="isColumnHide('LR_DATE')"
                                        mat-header-cell
                                        *matHeaderCellDef
                                    >
                                        LR Date
                                    </th>
                                    <td
                                        [hidden]="isColumnHide('LR_DATE')"
                                        mat-cell
                                        *matCellDef="
                                            let element;
                                            let index = index
                                        "
                                        (click)="invoiceRowClick(index)"
                                    >
                                        {{
                                            InvoiceDetailsFormGroup.get(
                                                "InvoiceDetails"
                                            )?.controls[index]?.get("LR_DATE")
                                                ?.value | date : "dd/MM/yyyy"
                                        }}
                                    </td>
                                </ng-container>

                                <ng-container matColumnDef="VEHICLE_NO">
                                    <th
                                        [hidden]="isColumnHide('VEHICLE_NO')"
                                        mat-header-cell
                                        *matHeaderCellDef
                                    >
                                        Vehicle No
                                    </th>
                                    <td
                                        [hidden]="isColumnHide('VEHICLE_NO')"
                                        mat-cell
                                        *matCellDef="
                                            let element;
                                            let index = index
                                        "
                                        (click)="invoiceRowClick(index)"
                                    >
                                        {{
                                            InvoiceDetailsFormGroup.get(
                                                "InvoiceDetails"
                                            )?.controls[index]?.get(
                                                "VEHICLE_NO"
                                            )?.value
                                        }}
                                    </td>
                                </ng-container>

                                <ng-container matColumnDef="CARRIER">
                                    <th
                                        [hidden]="isColumnHide('CARRIER')"
                                        mat-header-cell
                                        *matHeaderCellDef
                                    >
                                        Carrier
                                    </th>
                                    <td
                                        [hidden]="isColumnHide('CARRIER')"
                                        mat-cell
                                        *matCellDef="
                                            let element;
                                            let index = index
                                        "
                                        (click)="invoiceRowClick(index)"
                                    >
                                        {{
                                            InvoiceDetailsFormGroup.get(
                                                "InvoiceDetails"
                                            )?.controls[index]?.get("CARRIER")
                                                ?.value
                                        }}
                                    </td>
                                </ng-container>

                                <ng-container matColumnDef="VEHICLE_CAPACITY">
                                    <th
                                        [hidden]="
                                            isColumnHide('VEHICLE_CAPACITY')
                                        "
                                        mat-header-cell
                                        *matHeaderCellDef
                                    >
                                        Vehicle Capacity
                                    </th>
                                    <td
                                        [hidden]="
                                            isColumnHide('VEHICLE_CAPACITY')
                                        "
                                        mat-cell
                                        *matCellDef="
                                            let element;
                                            let index = index
                                        "
                                        (click)="invoiceRowClick(index)"
                                    >
                                        {{
                                            InvoiceDetailsFormGroup.get(
                                                "InvoiceDetails"
                                            )?.controls[index]?.get(
                                                "VEHICLE_CAPACITY"
                                            )?.value
                                        }}
                                    </td>
                                </ng-container>

                                <ng-container matColumnDef="EWAYBILL_NO">
                                    <th
                                        [hidden]="isColumnHide('EWAYBILL_NO')"
                                        mat-header-cell
                                        *matHeaderCellDef
                                    >
                                        E-way bill No
                                    </th>
                                    <td
                                        [hidden]="isColumnHide('EWAYBILL_NO')"
                                        mat-cell
                                        *matCellDef="
                                            let element;
                                            let index = index
                                        "
                                        (click)="invoiceRowClick(index)"
                                    >
                                        {{
                                            InvoiceDetailsFormGroup.get(
                                                "InvoiceDetails"
                                            )?.controls[index]?.get(
                                                "EWAYBILL_NO"
                                            )?.value
                                        }}
                                    </td>
                                </ng-container>

                                <ng-container matColumnDef="EWAYBILL_DATE">
                                    <th
                                        [hidden]="isColumnHide('EWAYBILL_DATE')"
                                        mat-header-cell
                                        *matHeaderCellDef
                                    >
                                        E-way bill No Date
                                    </th>
                                    <td
                                        [hidden]="isColumnHide('EWAYBILL_DATE')"
                                        mat-cell
                                        *matCellDef="
                                            let element;
                                            let index = index
                                        "
                                        (click)="invoiceRowClick(index)"
                                    >
                                        {{
                                            InvoiceDetailsFormGroup.get(
                                                "InvoiceDetails"
                                            )?.controls[index]?.get(
                                                "EWAYBILL_DATE"
                                            )?.value | date : "dd/MM/yyyy"
                                        }}
                                    </td>
                                </ng-container>

                                <ng-container matColumnDef="FREIGHT_ORDER">
                                    <th
                                        [hidden]="isColumnHide('FREIGHT_ORDER')"
                                        mat-header-cell
                                        *matHeaderCellDef
                                    >
                                        Freight Order
                                    </th>
                                    <td
                                        [hidden]="isColumnHide('FREIGHT_ORDER')"
                                        mat-cell
                                        *matCellDef="
                                            let element;
                                            let index = index
                                        "
                                    >
                                        {{
                                            InvoiceDetailsFormGroup.get(
                                                "InvoiceDetails"
                                            )?.controls[index]?.get(
                                                "FREIGHT_ORDER"
                                            )?.value
                                        }}
                                    </td>
                                </ng-container>

                                <ng-container matColumnDef="FREIGHT_ORDER_DATE">
                                    <th
                                        [hidden]="
                                            isColumnHide('FREIGHT_ORDER_DATE')
                                        "
                                        mat-header-cell
                                        *matHeaderCellDef
                                    >
                                        Freight Order Date
                                    </th>
                                    <td
                                        [hidden]="
                                            isColumnHide('FREIGHT_ORDER_DATE')
                                        "
                                        mat-cell
                                        *matCellDef="
                                            let element;
                                            let index = index
                                        "
                                        (click)="invoiceRowClick(index)"
                                    >
                                        {{
                                            InvoiceDetailsFormGroup.get(
                                                "InvoiceDetails"
                                            )?.controls[index]?.get(
                                                "FREIGHT_ORDER_DATE"
                                            )?.value | date : "dd/MM/yyyy"
                                        }}
                                    </td>
                                </ng-container>

                                <ng-container
                                    matColumnDef="PROPOSED_DELIVERY_DATE"
                                >
                                    <th
                                        [hidden]="
                                            isColumnHide(
                                                'PROPOSED_DELIVERY_DATE'
                                            )
                                        "
                                        mat-header-cell
                                        *matHeaderCellDef
                                    >
                                        Proposed Delivery Date
                                    </th>
                                    <td
                                        [hidden]="
                                            isColumnHide(
                                                'PROPOSED_DELIVERY_DATE'
                                            )
                                        "
                                        mat-cell
                                        *matCellDef="
                                            let element;
                                            let index = index
                                        "
                                        (click)="invoiceRowClick(index)"
                                    >
                                        {{
                                            InvoiceDetailsFormGroup.get(
                                                "InvoiceDetails"
                                            )?.controls[index]?.get(
                                                "PROPOSED_DELIVERY_DATE"
                                            )?.value | date : "dd/MM/yyyy"
                                        }}
                                    </td>
                                </ng-container>

                                <ng-container
                                    matColumnDef="VEHICLE_REPORTED_DATE"
                                >
                                    <th
                                        mat-header-cell
                                        *matHeaderCellDef
                                        style="width: 180px"
                                    >
                                        Vehicle Unloaded Date
                                    </th>
                                    <td
                                        mat-cell
                                        *matCellDef="
                                            let element;
                                            let index = index
                                        "
                                        style="width: 180px"
                                        [formGroupName]="index"
                                    >
                                        <mat-form-field
                                            class="pl-8 pr-12"
                                            appearance="outline"
                                            style="width: 150px"
                                        >
                                            <input
                                                matInput
                                                [matDatepicker]="picker30"
                                                formControlName="VEHICLE_REPORTED_DATE"
                                                [min]="
                                                    InvoiceDetailsFormGroup.get(
                                                        'InvoiceDetails'
                                                    ).controls[index]?.get(
                                                        'LR_DATE'
                                                    )?.value
                                                        ? InvoiceDetailsFormGroup.get(
                                                              'InvoiceDetails'
                                                          ).controls[
                                                              index
                                                          ]?.get('LR_DATE')
                                                              ?.value
                                                        : InvoiceDetailsFormGroup.get(
                                                              'InvoiceDetails'
                                                          ).controls[
                                                              index
                                                          ]?.get('INV_DATE')
                                                              ?.value
                                                        ? InvoiceDetailsFormGroup.get(
                                                              'InvoiceDetails'
                                                          ).controls[
                                                              index
                                                          ]?.get('INV_DATE')
                                                              ?.value
                                                        : minDate
                                                "
                                                [max]="maxDate"
                                                (click)="picker30.open()"
                                            />
                                            <mat-datepicker-toggle
                                                matSuffix
                                                [for]="picker30"
                                            >
                                            </mat-datepicker-toggle>
                                            <mat-datepicker
                                                #picker30
                                            ></mat-datepicker>
                                            <mat-error
                                                *ngIf="
                                                    InvoiceDetailsFormGroup.get(
                                                        'InvoiceDetails'
                                                    ).controls[index]?.get(
                                                        'VEHICLE_REPORTED_DATE'
                                                    ).touched &&
                                                    InvoiceDetailsFormGroup.get(
                                                        'InvoiceDetails'
                                                    )
                                                        .controls[index]?.get(
                                                            'VEHICLE_REPORTED_DATE'
                                                        )
                                                        .hasError('required')
                                                "
                                            >
                                                *
                                            </mat-error>
                                        </mat-form-field>
                                    </td>
                                </ng-container>

                                <ng-container
                                    matColumnDef="ACTUAL_DELIVERY_DATE"
                                >
                                    <th
                                        [hidden]="
                                            isColumnHide('ACTUAL_DELIVERY_DATE')
                                        "
                                        mat-header-cell
                                        *matHeaderCellDef
                                    >
                                        Acknowledgement Date
                                    </th>
                                    <td
                                        [hidden]="
                                            isColumnHide('ACTUAL_DELIVERY_DATE')
                                        "
                                        mat-cell
                                        *matCellDef="
                                            let element;
                                            let index = index
                                        "
                                        (click)="invoiceRowClick(index)"
                                    >
                                        {{
                                            InvoiceDetailsFormGroup.get(
                                                "InvoiceDetails"
                                            )?.controls[index]?.get(
                                                "ACTUAL_DELIVERY_DATE"
                                            )?.value
                                                | date : "dd/MM/yyyy hh:mm:ss"
                                        }}
                                    </td>
                                </ng-container>

                                <ng-container matColumnDef="TRANSIT_LEAD_TIME">
                                    <th
                                        [hidden]="
                                            isColumnHide('TRANSIT_LEAD_TIME')
                                        "
                                        mat-header-cell
                                        *matHeaderCellDef
                                    >
                                        Lead time
                                    </th>
                                    <td
                                        [hidden]="
                                            isColumnHide('TRANSIT_LEAD_TIME')
                                        "
                                        mat-cell
                                        *matCellDef="
                                            let element;
                                            let index = index
                                        "
                                        (click)="invoiceRowClick(index)"
                                    >
                                        {{
                                            InvoiceDetailsFormGroup.get(
                                                "InvoiceDetails"
                                            )?.controls[index]?.get(
                                                "TRANSIT_LEAD_TIME"
                                            )?.value
                                        }}
                                    </td>
                                </ng-container>

                                <ng-container matColumnDef="DRIVER_CONTACT">
                                    <th
                                        [hidden]="
                                            isColumnHide('DRIVER_CONTACT')
                                        "
                                        mat-header-cell
                                        *matHeaderCellDef
                                    >
                                        Driver Contact
                                    </th>
                                    <td
                                        [hidden]="
                                            isColumnHide('DRIVER_CONTACT')
                                        "
                                        mat-cell
                                        *matCellDef="
                                            let element;
                                            let index = index
                                        "
                                        [formGroupName]="index"
                                        (click)="invoiceRowClick(index)"
                                    >
                                        {{
                                            InvoiceDetailsFormGroup.get(
                                                "InvoiceDetails"
                                            )?.controls[index]?.get(
                                                "DRIVER_CONTACT"
                                            )?.value
                                        }}
                                    </td>
                                </ng-container>

                                <ng-container matColumnDef="TRACKING_LINK">
                                    <th
                                        [hidden]="isColumnHide('TRACKING_LINK')"
                                        mat-header-cell
                                        *matHeaderCellDef
                                    >
                                        Tracking Link
                                    </th>
                                    <td
                                        [hidden]="isColumnHide('TRACKING_LINK')"
                                        mat-cell
                                        *matCellDef="
                                            let element;
                                            let index = index
                                        "
                                        [formGroupName]="index"
                                    >
                                        <button
                                            mat-raised-button
                                            class="btnBg"
                                            (click)="
                                                trackProduct(
                                                    element.TRACKING_LINK
                                                )
                                            "
                                        >
                                            Track
                                        </button>
                                    </td>
                                </ng-container>

                                <ng-container matColumnDef="TOTAL_DISTANCE">
                                    <th
                                        [hidden]="
                                            isColumnHide('TOTAL_DISTANCE')
                                        "
                                        mat-header-cell
                                        *matHeaderCellDef
                                    >
                                        Total Distance
                                    </th>
                                    <td
                                        [hidden]="
                                            isColumnHide('TOTAL_DISTANCE')
                                        "
                                        mat-cell
                                        *matCellDef="
                                            let element;
                                            let index = index
                                        "
                                        [formGroupName]="index"
                                        (click)="invoiceRowClick(index)"
                                    >
                                        {{
                                            InvoiceDetailsFormGroup.get(
                                                "InvoiceDetails"
                                            )?.controls[index]?.get(
                                                "TOTAL_DISTANCE"
                                            )?.value
                                        }}
                                    </td>
                                </ng-container>

                                <ng-container matColumnDef="TOTAL_TRAVEL_TIME">
                                    <th
                                        [hidden]="
                                            isColumnHide('TOTAL_TRAVEL_TIME')
                                        "
                                        mat-header-cell
                                        *matHeaderCellDef
                                    >
                                        Travel Time
                                    </th>
                                    <td
                                        [hidden]="
                                            isColumnHide('TOTAL_TRAVEL_TIME')
                                        "
                                        mat-cell
                                        *matCellDef="
                                            let element;
                                            let index = index
                                        "
                                        [formGroupName]="index"
                                        (click)="invoiceRowClick(index)"
                                    >
                                        {{
                                            InvoiceDetailsFormGroup.get(
                                                "InvoiceDetails"
                                            )?.controls[index]?.get(
                                                "TOTAL_TRAVEL_TIME"
                                            )?.value
                                        }}
                                    </td>
                                </ng-container>

                                <ng-container matColumnDef="STATUS">
                                    <th
                                        [hidden]="isColumnHide('STATUS')"
                                        mat-header-cell
                                        *matHeaderCellDef
                                    >
                                        Status
                                    </th>
                                    <td
                                        [hidden]="isColumnHide('STATUS')"
                                        mat-cell
                                        *matCellDef="
                                            let element;
                                            let index = index
                                        "
                                        [formGroupName]="index"
                                        (click)="invoiceRowClick(index)"
                                    >
                                        {{
                                            InvoiceDetailsFormGroup.get(
                                                "InvoiceDetails"
                                            )?.controls[index]?.get("STATUS")
                                                ?.value
                                        }}
                                    </td>
                                </ng-container>

                                <ng-container matColumnDef="REMARKS">
                                    <th
                                        [hidden]="isColumnHide('REMARKS')"
                                        mat-header-cell
                                        *matHeaderCellDef
                                    >
                                        Customer Remarks
                                    </th>
                                    <td
                                        [hidden]="isColumnHide('REMARKS')"
                                        mat-cell
                                        *matCellDef="
                                            let element;
                                            let index = index
                                        "
                                        [formGroupName]="index"
                                        (click)="invoiceRowClick(index)"
                                    >
                                        {{
                                            InvoiceDetailsFormGroup.get(
                                                "InvoiceDetails"
                                            )?.controls[index]?.get("REMARKS")
                                                ?.value
                                        }}
                                    </td>
                                </ng-container>

                                <ng-container matColumnDef="VIEW">
                                    <th
                                        [hidden]="isColumnHide('VIEW')"
                                        mat-header-cell
                                        *matHeaderCellDef
                                    >
                                        View
                                    </th>
                                    <td
                                        [hidden]="isColumnHide('VIEW')"
                                        mat-cell
                                        *matCellDef="
                                            let element;
                                            let index = index
                                        "
                                        class="pl-12"
                                    >
                                        <div fxLayout="row" fxLayoutGap="16px">
                                            <mat-icon
                                                svgIcon="photoIcon"
                                                matTooltip="view attachment"
                                                *ngIf="
                                                    InvoiceDetailsFormGroup.get(
                                                        'InvoiceDetails'
                                                    )?.controls[index]?.get(
                                                        'ATTACHMENT_ID'
                                                    )?.value
                                                "
                                                aria-label="file_download"
                                                (click)="
                                                    DowloandPODDocument(
                                                        InvoiceDetailsFormGroup.get(
                                                            'InvoiceDetails'
                                                        )?.controls[index]?.get(
                                                            'HEADER_ID'
                                                        )?.value,
                                                        InvoiceDetailsFormGroup.get(
                                                            'InvoiceDetails'
                                                        )?.controls[index]?.get(
                                                            'ATTACHMENT_ID'
                                                        )?.value,
                                                        InvoiceDetailsFormGroup.get(
                                                            'InvoiceDetails'
                                                        )?.controls[index]?.get(
                                                            'ATTACHMENT_NAME'
                                                        )?.value
                                                    )
                                                "
                                            >
                                            </mat-icon>

                                            <mat-icon
                                                svgIcon="uploadIcon"
                                                aria-label="reupload"
                                                matTooltip="re-upload lr"
                                                *ngIf="
                                                    (currentUserRole
                                                        | lowercase) ===
                                                        'customer' &&
                                                    InvoiceDetailsFormGroup.get(
                                                        'InvoiceDetails'
                                                    )?.controls[index]?.get(
                                                        'ATTACHMENT_ID'
                                                    )?.value
                                                "
                                                (click)="
                                                    ReUploadInvoiceAttachment(
                                                        index
                                                    )
                                                "
                                            >
                                            </mat-icon>
                                        </div>
                                    </td>
                                </ng-container>

                                <ng-container matColumnDef="Action">
                                    <th mat-header-cell *matHeaderCellDef>
                                        Action
                                    </th>
                                    <td
                                        mat-cell
                                        *matCellDef="
                                            let element;
                                            let index = index
                                        "
                                    >
                                        <div fxLayout="row" fxLayoutGap="16px">
                                            <button
                                                *ngIf="
                                                    (currentUserRole
                                                        | lowercase) ===
                                                        'customer' &&
                                                    !InvoiceDetailsFormGroup.get(
                                                        'InvoiceDetails'
                                                    )?.controls[index]?.get(
                                                        'ATTACHMENT_ID'
                                                    )?.value &&
                                                    !InvoiceDetailsFormGroup.get(
                                                        'InvoiceDetails'
                                                    )
                                                        ?.controls[index]?.get(
                                                            'STATUS'
                                                        )
                                                        ?.value.toLowerCase()
                                                        .includes('confirmed')
                                                "
                                                mat-raised-button
                                                class="mr-4 btnBg"
                                                (click)="
                                                    SaveAndUploadInvoiceItem(
                                                        index
                                                    )
                                                "
                                            >
                                                Confirm
                                            </button>
                                            <button
                                                *ngIf="
                                                    (currentUserRole
                                                        | lowercase) ===
                                                        'customer' &&
                                                    InvoiceDetailsFormGroup.get(
                                                        'InvoiceDetails'
                                                    )?.controls[index]?.get(
                                                        'ATTACHMENT_ID'
                                                    )?.value &&
                                                    !InvoiceDetailsFormGroup.get(
                                                        'InvoiceDetails'
                                                    )
                                                        ?.controls[index]?.get(
                                                            'STATUS'
                                                        )
                                                        ?.value.toLowerCase()
                                                        .includes('confirmed')
                                                "
                                                mat-raised-button
                                                class="mr-4 btnBg"
                                                (click)="
                                                    ConfirmInvoiceItemWithoutAttachment(
                                                        index
                                                    )
                                                "
                                            >
                                                Confirm Qty
                                            </button>

                                            <input
                                                hidden
                                                type="file"
                                                accept="application/pdf,image/jpg,image/jpeg,.png,image/*"
                                                #fileInput
                                                id="file"
                                                (change)="
                                                    handleFileInput($event)
                                                "
                                            />
                                            <input
                                                hidden
                                                type="file"
                                                accept="application/pdf,image/jpg,image/jpeg,.png,image/*"
                                                #fileInput1
                                                id="file1"
                                                (change)="
                                                    handleFileInput1($event)
                                                "
                                            />
                                        </div>
                                    </td>
                                </ng-container>

                                <tr
                                    mat-header-row
                                    *matHeaderRowDef="
                                        displayedColumns;
                                        sticky: true
                                    "
                                ></tr>
                                <tr
                                    mat-row
                                    *matRowDef="
                                        let row;
                                        columns: displayedColumns;
                                        let index = index
                                    "
                                    style="cursor: pointer !important"
                                ></tr>
                            </table>
                            <div *ngIf="!allInvoiceDetails?.length">
                                <mat-icon
                                    svgIcon="infoIcon"
                                    style="
                                        color: #1b56ca;
                                        margin-top: 10px;
                                        margin-left: 70px;
                                    "
                                ></mat-icon>
                                <span style="margin-left: 10px"
                                    >The table does not contain any data</span
                                >
                            </div>
                        </div>
                    </form>
                </div>
                <div flex>
                    <mat-paginator
                        [style.display]="
                            allInvoiceDetails?.length ? 'inherit' : 'none'
                        "
                        [pageSizeOptions]="[5, 10, 25, 50, 100, 200, 500, 1000]"
                        showFirstLastButtons
                    >
                    </mat-paginator>
                </div>
            </div>
        </div>
    </div>
    <mat-progress-spinner
        *ngIf="isProgressBarVisibile"
        class="progressBarPostion"
        color="accent"
        mode="indeterminate"
    >
    </mat-progress-spinner>
    <div id="overlay" *ngIf="isProgressBarVisibile"></div>
</div>
